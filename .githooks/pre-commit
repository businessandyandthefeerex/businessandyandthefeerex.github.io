#!/bin/bash

# Define the relative paths to the scripts
GEOLOC_SCRIPT="./assets/scripts/generate_geocoded_locations.sh"
LEAFLET_SCRIPT="./assets/scripts/generate_leaflet_markers.sh"

# Check if Ruby is installed
if ! command -v ruby &> /dev/null; then
  echo "Ruby is not installed. Please install Ruby and try again."
  exit 1
fi

# Check if the geocoding script exists and is executable
if [ ! -x "$GEOLOC_SCRIPT" ]; then
  echo "Geocoding script is not executable or not found: $GEOLOC_SCRIPT"
  exit 1
fi

# Check if the leaflet markers script exists and is executable
if [ ! -x "$LEAFLET_SCRIPT" ]; then
  echo "Leaflet markers script is not executable or not found: $LEAFLET_SCRIPT"
  exit 1
fi

# Run the geocoding script
echo "Running geocoding script..."
"$GEOLOC_SCRIPT"
if [ $? -ne 0 ]; then
  echo "Geocoding script failed. Push aborted."
  exit 1
fi

# Run the leaflet markers script
echo "Running leaflet markers script..."
"$LEAFLET_SCRIPT"
if [ $? -ne 0 ]; then
  echo "Leaflet markers script failed. Push aborted."
  exit 1
fi

# Allow the push to continue
echo "All scripts executed successfully. Push allowed."
exit 0
